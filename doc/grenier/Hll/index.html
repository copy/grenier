<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Hll (grenier.Hll)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../index.html">grenier</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">Hll</span></h1></header><p>An implementation of HyperLogLog probabilistic cardinality estimator.</p><div class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>t</code><code></code><code></code></div><div class="doc"><p>Type of HyperLogLog counters</p></div></div><div class="spec val" id="val-make"><a href="#val-make" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>make : error:float <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div><div class="doc"><p>Create a new counter with <code class="code">error</code> error rate.
<code class="code">error</code> should verify <code class="code">0.0 &lt; error &amp;&amp; error &lt; 1.0</code>.
<code class="code">0.05</code> is a reasonable default.</p><p>Use <code class="code">estimate_memory</code> to measure memory consumption and runtime of this
function.</p></div></div><div class="spec val" id="val-add"><a href="#val-add" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>add : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> int64 <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p><code class="code">add t k</code> counts item <code class="code">k</code> in <code class="code">t</code>.</p><p><code class="code">k</code> should be &quot;random&quot;: it should be the output of some cryptographic
hashing algorithm like SHA. It is not treated as an integer.
This is key to getting proper results.
No patterns should appear in the bits of the different items added.</p><p>Runtime is O(1).</p></div></div><div class="spec val" id="val-estimate_memory"><a href="#val-estimate_memory" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>estimate_memory : error:float <span class="keyword">&#8209;&gt;</span> int</code></div><div class="doc"><p>Estimate the memory consumed in bytes by a counter with the specified error
rate.</p><p>This ignores the constant overhead of the OCaml representation, around two
words. It is a <code class="code">bytes</code> of <code class="code">estimate_memory ~error + 1</code> length.</p></div></div><div class="spec val" id="val-card"><a href="#val-card" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>card : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> float</code></div><div class="doc"><p>Get the cardinality estimation. Defaults to HyperLogLog++.</p></div></div><div class="spec val" id="val-card_hll"><a href="#val-card_hll" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>card_hll : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> float</code></div><div class="doc"></div></div><div class="spec val" id="val-card_hllpp"><a href="#val-card_hllpp" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>card_hllpp : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> float</code></div><div class="doc"></div></div><div class="spec val" id="val-copy"><a href="#val-copy" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>copy : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div><div class="doc"><p>Get a copy of a counter.</p></div></div><div class="spec val" id="val-merge"><a href="#val-merge" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>merge : into:<a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p><code class="code">merge ~into:t0 t'</code> has the same effect as adding all items added to
<code class="code">t'</code> to <code class="code">t0</code>.</p><p><code class="code">t0</code> and <code class="code">t'</code> must have been constructed with the same error rate!</p></div></div><div class="spec val" id="val-clear"><a href="#val-clear" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>clear : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p>Reset counter to 0.</p></div></div><div class="spec val" id="val-hash_int64"><a href="#val-hash_int64" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>hash_int64 : int64 <span class="keyword">&#8209;&gt;</span> int64</code></div><div class="doc"><p>The following algorithm provide a reasonable hashing function for integers,
if you want to feed the HLL with &quot;normal&quot; integers.</p></div></div><div class="h1">Serialization</div><div class="spec val" id="val-to_string"><a href="#val-to_string" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>to_string : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string</code></div><div class="doc"><p>Returns a string with the current state stored.</p></div></div><div class="spec val" id="val-of_string"><a href="#val-of_string" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>of_string : string <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div><div class="doc"><p>Restore a HLL saved with <code class="code">to_string</code>.</p><p><code class="code">of_string (to_string t)</code> is functionnally equivalent to <code class="code">copy t</code>,
except a bit more expensive.</p><p>It can raise <code class="code">Invalid_argument</code> if the string provided was not saved by
<code class="code">to_string</code>.</p></div></div></body></html>